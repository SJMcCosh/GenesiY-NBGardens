<ui:composition xmlns="https://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	template="templates/template.xhtml">
	<meta charset="ISO-8859-1" />
	<ui:define name="maincontent">

		<f:metadata>
			<f:event type="preRenderView" listener="#{reviewcon.getReviews}" />
		</f:metadata>

		<script type="text/javascript">
			//<![CDATA[				
			function performPostAjaxCommands() {
				$("#basket_item_removed_popup").show();
			}

			function closeRemoveItemPopup() {
				$("#basket_item_removed_popup").hide();
			}
			//]]>
		</script>


		<div id="basket_item_removed_popup">
			<img onclick="closeRemoveItemPopup()" id="item_popup_close_button"
				src="img/BasketImages/popupclose.png" />
			<p>Added to Basket</p>
		</div>

		<div class="maincontent">
			<div class="productcontent">

				<div id="productpage_upper_column">
					<p id="product_page_product_title"><h:outputText value="#{products.product.name}" /></p>
					<div id="product_page_product_price">
						<h:outputText value="#{products.product.price}">
							<f:convertNumber type="currency" currencyCode="GBP" />
						</h:outputText>
					</div>
				</div>

				<div id="productpage_left_column">
					<picture>
					<source srcset="img/gnome.jpg" media="(max-width: 600px)" />
					<img src="#{products.product.imageLocation}" style="width: auto;" /></picture>
				</div>
								
				<div id="productpage_right_column">
					<div id="productpage_right_column_inner">
					<h:form>
						
						<!-- Description for the product -->
						<div id="product_page_product_description_container">						
							<h:outputText value="#{products.product.description}" />							
						</div>
						<br/>
						<br/>
						<br/>
						<div id="product_page_product_qty_container">			
							<div id="product_page_product_qty_container_qty">
								<p>Qty:</p>	
							</div>		
							<div id="product_page_product_qty_container_dropdown">
								<h:selectOneMenu value="#{products.quantityOfItemsSelected}"
									onchange="submit()" id="product_qty_dropdown" style="height:60px">
									<f:selectItem itemValue="1" itemLabel="1" />
									<f:selectItem itemValue="2" itemLabel="2" />
									<f:selectItem itemValue="3" itemLabel="3" />
									<f:selectItem itemValue="4" itemLabel="4" />
									<f:selectItem itemValue="5" itemLabel="5" />
									<f:selectItem itemValue="6" itemLabel="6" />
									<f:selectItem itemValue="7" itemLabel="7" />
									<f:selectItem itemValue="8" itemLabel="8" />
									<f:selectItem itemValue="9" itemLabel="9" />
									<f:selectItem itemValue="10" itemLabel="10" />
								</h:selectOneMenu>	
							</div>
						</div>
											
						
						<div id="product_page_product_btn_container">
							<div id="product_page_product_btn">
								<p>Add to basket</p>
								<h:commandButton type="submit" name="addtocart"
									value="Add To Cart" action="#{addBasket.addToBasket}">
									<f:ajax execute="@form" render="@this basketlink"
										onevent="performPostAjaxCommands()" />
								</h:commandButton>
								
								
							</div>
						</div>
						
						
						<div id="product_page_product_stock_container">
							<img src="img/ProductPage/tick.png" />
							<div style="float:right;padding-left:20px">
								<p>In stock!</p>
							</div>
						</div>
						
						<!-- Stock -->
						<div>

							<h:outputText value = "#{products.stock}"/>

						</div>

						<!-- Cart button -->

						
					</h:form>
					</div>
				</div>

			</div>
			<hr />
			<!-- Related Products -->
			<h:form>
				<div class="related-products col-12 col-m-12">
					<h2>Related Products</h2>

					<div id="index_featured_products_scroll_section_outer">
						<div id="index_featured_products_scroll_section_inner">
							<ui:repeat var="product" value="#{products.dataModel}">

								<div class="index_featured_products_product">
									<h:commandLink action="#{products.viewProduct(product)}">
										<img class="index_featured_products_product_image"
											src="#{product.imageLocation}" />
										<div class="index_featured_products_product_title">
											<h:outputText value="#{product.name}" />
										</div>
									</h:commandLink>
									<p>
										<h:outputText value="#{product.averageRating}"
											class="index_featured_products_product_price">
											<f:convertNumber type="currency" currencyCode="GBP" />
										</h:outputText>
									</p>
									<img src="#{products.averageRatingImg(product.averageRating)}" />

								</div>

								<div id="featured_items_padding"></div>
							</ui:repeat>
						</div>
					</div>
				</div>
			</h:form>

			<hr />
			<!-- Reviews -->
			<h:form class="reviews col-12 col-m-12">
				<h2>Reviews</h2>
				<ui:repeat var="reviews" value="#{reviewcon.dataModel}">
					<ul>
						<li>
							<div class="review">
								<h3 class="col-10 col-m-10">Person</h3>
								<!-- Star Rating -->
								<div class="col-2 col-m-2">
									<h:outputText value="#{reviews.rating}" />
								</div>

								<div class="col-12 col-m-12">
									<h:outputText value="#{reviews.reviewtext}" />
								</div>

							</div>
						</li>
					</ul>
				</ui:repeat>
			</h:form>
		</div>

	</ui:define>
</ui:composition>